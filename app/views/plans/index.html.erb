<p id="notice"><%= notice %></p>
<%= render 'devise/shared/navbar'%>
<div class="container">
<h1>Plans</h1>
  <table>
    <thead>
      <tr>
        <th>Monthly fee</th>
        <th> Name</th>
        <th colspan="3"></th>
        <% if current_user.usertype =='Admin'%>
          <th>Buyer</th>
        <%end%>
      </tr>
    </thead>

    <tbody>
      <% @plans.each do |plan| %>
        <tr>
          <td><%= plan.monthly_fee %></td>
          <td><%= plan.name %></td>
          <td><%= link_to button_tag('Show plan', class: 'btn btn-dark float-left'),plan %></td>

          <% if policy(plan).edit?%>
            <td><%= link_to button_tag('Edit plan', class: 'btn btn-dark float-left'),edit_plan_path(plan) %></td>
          <%end%>

          <% if policy(plan).destroy?%>
            <td><%= link_to button_tag('Delete plan', class: 'btn btn-danger'),plan, method: :delete, data: { confirm: 'Are you sure you want to delete this plan?' } %></td>
          <%end%>


          <% if current_user.usertype=='Admin'%>
            <td>
            <% plan.users.each do |user| %>
              <li><%=user.name %> </li>
            <%end%>
            </td>
          <%end%>
           <td><%= link_to button_tag('Create New Features', class: 'btn btn-dark float-left'),new_plan_feature_path(plan) %></td>
        </tr>
      <% end %>


    </tbody>

  </table>
  <br>
  <% if policy(Plan).create?%>
    <%= link_to button_tag('Create New Plan', class: 'btn btn-dark float-left'),new_plan_path %>
    <%# <%= link_to 'Create New Plan', new_plan_path %>
    <br>
  <% end %>
</div>
